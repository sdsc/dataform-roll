<?xml version="1.0" standalone="no"?>

<kickstart>

<description>
NETCDF/NCO utilities module files
http://www.unidata.ucar.edu/software/netcdf
http://nco.sourceforge.net
</description>

<copyright>
Copyright (c) 2000 - 2011 The Regents of the University of California.
All rights reserved. Rocks(r) v5.1 www.rocksclusters.org
</copyright>

<changelog>
</changelog>

<post>

<!-- netCDF/NCO -->

for COMPILER in `ls /opt/netcdf/3.6.2`; do

  /bin/mkdir -m 0755 -p /opt/modulefiles/applications/.$COMPILER/netcdf

  cat > /opt/modulefiles/applications/.$COMPILER/netcdf/3.6.2 << END
#%Module1.0
module-whatis "netcdf"
module-whatis "Version: 3.6.2" 
module-whatis "Description: netcdf"
module-whatis "Compiler: $COMPILER" 
set netcdfHome /opt/netcdf/3.6.2/$COMPILER
setenv NETCDFHOME $netcdfHome
prepend-path PATH $netcdfHome/bin
prepend-path LD_LIBRARY_PATH $netcdfHome/lib
prepend-path LIBPATH $netcdfHome/lib
set ncoHome /opt/nco/$COMPILER
setenv NCOHOME $ncoHome
prepend-path PATH $ncoHome/bin
prepend-path LD_LIBRARY_PATH $ncoHome/lib
prepend-path LIBPATH $ncoHome/lib
END
  chmod 0644 /opt/modulefiles/applications/.$COMPILER/netcdf/3.6.2

  cat > /opt/modulefiles/applications/.$COMPILER/netcdf/.version.3.6.2 << END
#%Module1.0
set ModulesVersion "3.6.2"
END
  chmod 0644 /opt/modulefiles/applications/.$COMPILER/netcdf/.version.3.6.2

done

for COMPILER in `ls /opt/netcdf/4.0.1`; do

  cat > /opt/modulefiles/applications/.$COMPILER/netcdf/4.0.1 << END
#%Module1.0
module-whatis "netcdf"
module-whatis "Version: 4.0.1" 
module-whatis "Description: netcdf"
module-whatis "Compiler: $COMPILER" 
set netcdfHome /opt/netcdf/4.0.1/$COMPILER
setenv NETCDFHOME $netcdfHome
prepend-path PATH $netcdfHome/bin
prepend-path LD_LIBRARY_PATH $netcdfHome/lib
prepend-path LIBPATH $netcdfHome/lib
set ncoHome /opt/nco/$COMPILER
setenv NCOHOME $ncoHome
prepend-path PATH $ncoHome/bin
prepend-path LD_LIBRARY_PATH $ncoHome/lib
prepend-path LIBPATH $ncoHome/lib
END
  chmod 0644 /opt/modulefiles/applications/.$COMPILER/netcdf/4.0.1

  cat > /opt/modulefiles/applications/.$COMPILER/netcdf/.version.4.0.1 << END
#%Module1.0
set ModulesVersion "4.0.1"
END
  chmod 0644 /opt/modulefiles/applications/.$COMPILER/netcdf/.version.4.0.1

  /bin/ln -s /opt/modulefiles/applications/.$COMPILER/netcdf/.version.4.0.1 \
             /opt/modulefiles/applications/.$COMPILER/netcdf/.version

done

</post>

</kickstart>
